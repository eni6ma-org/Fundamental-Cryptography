# Cryptographic apparatus and method

### InventorMartin : E. HellmanBailey W. DiffieRalph C. MerkleCurrent 
### Assignee :  Stanford  University

## Abstract
A cryptographic system transmits a computationally secure cryptogram over an insecure communication channel without prearrangement of a cipher key. A secure cipher key is generated by the conversers from transformations of exchanged transformed signals. The conversers each possess a secret signal and exchange an initial transformation of the secret signal with the other converser. The received transformation of the other converser's secret signal is again transformed with the receiving converser's secret signal to generate a secure cipher key. The transformations use non-secret operations that are easily performed but extremely difficult to invert. It is infeasible for an eavesdropper to invert the initial transformation to obtain either conversers' secret signal, or duplicate the latter transformation to obtain the secure cipher key.

## The Claims

| Claim | Description |
|------|-------------|
| 1    | A secure key generator comprising: a first input connected to receive an applied first signal; a second input connected to receive an applied second signal; a first output; a second output; and means for generating at the first output a third signal, that is a transformation of said first signal and which transformation is infeasible to invert, and for generating at the second output a fourth signal, that is a transformation of said second signal with said first signal, which represents a secure key and is infeasible to generate solely with said second signal and said third signal. |
| 2    | In a method of communicating securely over an insecure communication channel of the type which communicates a message from a transmitter to a receiver, the improvement characterized by: generating and transforming, in a manner infeasible to invert, a first signal at the transmitter to generate a transformed first signal; generating and transforming, in a manner infeasible to invert, a second signal at the receiver to generate a transformed second signal; transmitting said transformed first signal from the transmitter to the receiver; transmitting said transformed second signal from the receiver to the transmitter; transforming said transformed second signal with said first signal at the transmitter to generate a third signal, representing a secure cipher key, that is infeasible to generate solely with said transformed first signal and said transformed second signal; transforming said transformed first signal with said second signal at the receiver to generate a fourth signal that is identical to the third signal and represents said secure cipher key; enciphering the message with said secure cipher key at the transmitter; transmitting the enciphered message from the transmitter to the receiver; and deciphering the enciphered message with said secure cipher key at the receiver. |
| 3    | In a method of communicating securely over an insecure communication channel as in claim 2, further comprising: authenticating the receiver's identity at the transmitter from the receiver's ability to generate the fourth signal, representing the secure cipher key. |
| 4    | A method of generating a secure cipher key between a transmitter and receiver comprising the steps of: generating and transforming, in a manner infeasible to invert, a first signal at the transmitter to generate a transformed first signal; generating and transforming, in a manner infeasible to invert, a second signal at the receiver to generate a transformed second signal; transmitting said transformed first signal from the transmitter to the receiver; transmitting said transformed second signal from the receiver to the transmitter; transforming said transformed second signal with said first signal at the transmitter to generate a third signal, representing a secure cipher key, that is infeasible to generate solely with said transformed first signal and said transformed second signal; and transforming said transformed first signal with said second signal at the receiver to generate a fourth signal that is identical to the third signal and represents said secure cipher key. |
| 5    | An apparatus for generating a secure cipher key comprising: a first secure key generator having a first input connected to receive an applied first signal, having a second input connected to receive a second signal, having a first and second outputs, and having a means for generating at the first output a third signal, that is a transformation of said first signal and which transformation is infeasible to invert, and for generating at the second output a fourth signal, that is a transformation of said second signal with said first signal, which represents a secure key and is infeasible to generate solely with said second signal and said third signal; and a second secure key generator having a first input connected to receive an applied fifth signal, having a second input connected to receive said third signal, having a first and second outputs, and having a means for generating at the first output said second signal, that is a transformation of said fifth signal and which transformation is infeasible to invert, and for generating at the second output a sixth signal, that is a transformation of said third signal with said fifth signal, which represents the secure key and is infeasible to generate solely with said second signal and said third signal. |
| 6    | A method of generating a secure cipher key between a transmitter and receiver comprising the steps of: transforming, in a manner infeasible to invert, a first signal at the transmitter to generate a transformed first signal wherein transforming said first signal is performed by raising a first number to a power represented by said first signal, modulo a second number; transforming, in a manner infeasible to invert, a second signal at the receiver to generate a transformed second signal, wherein transforming said second signal is performed by raising the first number to a power represented by said second signal, modulo the second number; transmitting said transformed first signal from the transmitter to the receiver; transmitting said transformed second signal from the receiver to the transmitter; transforming said transformed second signal with said first signal at the transmitter to generate a third signal, representing a secure cipher key, that is infeasible to generate solely with said transformed first signal and said transformed second signal, wherein transforming said transformed second signal with said first signal is performed by raising a number represented by said transformed second signal to a power represented by said first signal, modulo the second number; and transforming said transformed first signal with said second signal at the receiver to generate a fourth signal, representing said secure cipher key, that is infeasible to generate solely with said transformed first signal and said transformed second signal, wherein transforming said transformed first signal with said second signal is performed by raising a number represented by said transformed first signal to a power represented by said second signal, modulo the second number. |
| 7    | An apparatus for generating a secure cipher key comprising: a first secure key generator having a first input connected to receive an applied first signal, having a second input connected to receive a second signal, having first and second outputs, and having a means for generating at the first output a third signal, that is a transformation of said first signal in which said transformation includes raising a first number to a power represented by said first signal, modulo or second number, and for generating at the second output a fourth signal, that is a transformation of said second signal with said first signal which transformation includes raising a number represented by said second signal to a power represented by said first signal, modulo the second number, which represents a secure key and is infeasible to generate solely with said second signal and said third signal; and a second secure key generator having a first input connected to receive an applied fifth signal, having a second input connected to receive said third signal, having a first and second outputs, and having a means for generating at the first output said second signal, that is a transformation of said fifth signal in which said transformation includes raising a first number to a power represented by said fifth signal, modulo the second number, and for generating at the second output a sixth signal, that is a transformation of a said third signal with said fifth signal which transformation includes raising a number represented by said third signal to a power represented by said fifth signal, modulo the second number, which represents the secure key and is infeasible to generate solely with said second signal and said third signal. |
| 8    | An apparatus for generating a secure cipher key comprising: a first secure key generator having a first input connected to receive an applied first signal, having a second input connected to receive a second signal, having a first and second outputs, and having a means for generating at the first output a third signal, said third signal \(Y_i\) being described by \(Y_i = a^{x_i} \mod q\) where \(q\) is a large prime number, \(a\) is a random number, such that \(1 \leq a \leq q-1\), \(x_i\) is the first signal which represents a random number, such that \(1 \leq X_i \leq q-1\) a transformation of said first signal which is infeasible to invert, and for generating at the second output a fourth signal, said fourth signal \(K_{ij}\) being described by \(K_{ij} = Y_j^{X_i} \mod q\) where \(Y_j\) is the second signal a transformation of said second signal with said first signal, which represents said secure cipher key and is infeasible to generate solely with said second signal and said third signal; and a second secure key generator having a first input connected to receive an applied fifth signal, having a second input connected to receive said third signal, having a first and second outputs, and having a means for generating at the first output a second signal, said second signal \(Y_j\) being described by \(Y_j = a^{X_j} \mod q\) where \(X_j\) is the fifth signal which represents a random number, such that \(1 \leq X_j \leq q-1\) a transformation of said fifth signal which is infeasible to invert, and for generating at the second output a sixth signal, said sixth signal \(K_{ij}\) being described by \(K_{ij} = Y_i^{X_j} \mod q\) a transformation of said third signal with said fifth signal, which represents the secure key and is infeasible to generate solely with said second signal and said third signal. |


## Diffie-Hellman Key Exchange Algorithm  

1. **Transformation and Exchange Process:**
    - Each participant (converser) begins with a secret signal.
    - They transform their secret signal using public parameters and exchange the transformed signal with the other participant.
    - The transformation involves raising a base number to the power of their secret signal, modulo a large prime number.
    - The received transformed signal from the other participant is then re-transformed with the participant's own secret signal to generate a secure cipher key.

2. **Equations Involved:**
    - **Initial Transformation:** $Y_i = a^{X_i} \mod q$
      - Where $Y_i$ is the transformed signal, $a$ is the base number, $X_i$ is the secret signal, and $q$ is the large prime number.
    - **Secure Cipher Key Generation:** $K = (Y_j)^{X_i} \mod q = a^{X_i X_j} \mod q$
      - $K$ is the secure cipher key generated by both participants using the other's transformed signal $Y_j$ and their own secret signal $X_i$.

3. **Implementation Details:**
    - The transformation functions use non-secret operations that are easy to perform but difficult to invert, making it infeasible for an eavesdropper to obtain the secret signals or the secure cipher key.
    - The secure key generation method described allows communication over an insecure channel without prior exchange of a cipher key, enhancing security and privacy.


Initial Signal Transformation:
- For Converser $i$: $γ_i = α^{ξ_i} \mod ϑ$
  
Secure Cipher Key Generation:
For Converser 1:
$κ = γ_2^{ξ_1} \mod ϑ$
For Converser 2:
$κ = γ_1^{ξ_2} \mod ϑ$


Symbol Key:
- $α$: Public base used for transformation.
- $ξ_i$: Secret signal of the $x_i$ th converser.
- $γ_i$: Transformed signal of the $x_i$ th converser.
- $ϑ$: Large prime number.
- $κ$: Secure cipher key generated.


